<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5. 타이머 함수</title>
    <style>
      /* CSS 스타일 정의: 페이지의 시각적인 요소를 꾸밉니다. */
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 50px auto;
        padding: 20px;
      }
      .section {
        margin: 30px 0;
        padding: 20px;
        background: #f5f5f5;
        border-radius: 5px;
      }
      button {
        padding: 10px 20px;
        margin: 5px;
        cursor: pointer;
        background: #009688;
        color: white;
        border: none;
        border-radius: 5px;
      }
      button:hover {
        background: #00796b;
      }
      button:disabled {
        background: #ccc;
        cursor: not-allowed;
      }
      .timer-display {
        font-size: 48px;
        text-align: center;
        padding: 30px;
        background: white;
        border-radius: 5px;
        margin: 20px 0;
        font-weight: bold;
        color: #009688;
      }
      .message-box {
        padding: 15px;
        margin: 10px 0;
        background: white;
        border-radius: 5px;
        min-height: 50px;
      }
      .notification {
        padding: 10px;
        margin: 5px 0;
        background: #4caf50;
        color: white;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <h1>5. 타이머 함수 (Timer Functions)</h1>

    <!-- setTimeout 예제 섹션: 일정 시간 후 한 번 실행 -->
    <div class="section">
      <h2>setTimeout - 일정 시간 후 한 번 실행</h2>
      <button onclick="testSetTimeout()">3초 후 메시지 표시</button>
      <div id="setTimeoutResult" class="message-box"></div>
    </div>

    <!-- setInterval 예제 섹션: 일정 시간마다 반복 실행 -->
    <div class="section">
      <h2>setInterval - 일정 시간마다 반복 실행</h2>
      <div class="timer-display" id="timer">0</div>
      <button onclick="startTimer()">타이머 시작</button>
      <button onclick="stopTimer()">타이머 중지</button>
      <button onclick="resetTimer()">리셋</button>
    </div>

    <!-- 타이머와 함께 동적 콘텐츠 생성 예제 섹션 -->
    <div class="section">
      <h2>타이머와 함께 동적 콘텐츠 생성</h2>
      <button onclick="startNotifications()">알림 시작</button>
      <button onclick="stopNotifications()">알림 중지</button>
      <div id="notificationContainer"></div>
    </div>

    <script>
      // 타이머를 제어하기 위한 변수들
      let timerInterval = null; // setInterval의 ID를 저장하여 중지할 때 사용
      let timerCount = 0; // 타이머의 카운트 값을 저장
      let notificationInterval = null; // 알림 생성 setInterval의 ID를 저장

      // 1. setTimeout 예제: 지정된 시간(밀리초) 이후에 한 번만 함수를 실행합니다.
      function testSetTimeout() {
        const result = document.querySelector("#setTimeoutResult"); // 결과를 표시할 DOM 요소 선택
        result.innerHTML = "3초를 기다리는 중..."; // 대기 메시지 표시

        // 3000밀리초(3초) 후에 콜백 함수를 실행합니다.
        setTimeout(() => {
          result.innerHTML =
            '<strong style="color: #4CAF50;">3초가 지났습니다! 메시지가 표시되었습니다.</strong>'; // 메시지 업데이트
        }, 3000); // 3000ms = 3초
      }

      // 2. setInterval 예제: 지정된 시간(밀리초) 간격으로 함수를 반복 실행합니다.
      function startTimer() {
        // 이미 타이머가 실행 중이면 (timerInterval 값이 있으면) 함수를 종료하여 중복 실행을 방지합니다.
        if (timerInterval) return;

        // 1000밀리초(1초)마다 콜백 함수를 반복 실행하고, 그 ID를 timerInterval에 저장합니다.
        timerInterval = setInterval(() => {
          timerCount++; // 카운트 1 증가
          document.querySelector("#timer").textContent = timerCount; // 화면에 업데이트된 카운트 표시
        }, 1000); // 1000ms = 1초
      }

      function stopTimer() {
        // timerInterval이 존재하면 (타이머가 실행 중이면) 타이머를 중지합니다.
        if (timerInterval) {
          clearInterval(timerInterval); // setInterval로 시작된 타이머를 중지합니다.
          timerInterval = null; // 타이머 ID를 초기화하여 중지 상태를 명확히 합니다.
        }
      }

      function resetTimer() {
        stopTimer(); // 타이머를 중지합니다.
        timerCount = 0; // 카운트 값을 0으로 초기화합니다.
        document.getElementById("timer").textContent = 0; // 화면의 타이머 표시를 0으로 리셋합니다.
      }

      // 3. 동적 콘텐츠 생성 예제: setInterval과 setTimeout을 조합하여 알림을 생성하고 자동으로 사라지게 합니다.
      function startNotifications() {
        // 이미 알림 생성이 실행 중이면 함수를 종료하여 중복 실행을 방지합니다.
        if (notificationInterval) return;

        // 2000밀리초(2초)마다 새로운 알림을 생성하는 함수를 반복 실행합니다.
        notificationInterval = setInterval(() => {
          const container = document.querySelector("#notificationContainer"); // 알림을 추가할 컨테이너 선택
          const notification = document.createElement("div"); // 새로운 div 요소 생성 (알림 카드)
          notification.className = "notification"; // CSS 클래스 적용
          notification.textContent = `알림 ${new Date().toLocaleTimeString()}`; // 현재 시간과 함께 알림 텍스트 설정

          container.prepend(notification); // 컨테이너의 맨 앞에 알림을 추가합니다.

          // 5000밀리초(5초) 후에 이 특정 알림을 자동으로 제거합니다.
          setTimeout(() => {
            notification.remove(); // DOM에서 해당 알림 요소를 제거합니다.
          }, 5000); // 5000ms = 5초
        }, 2000); // 2000ms = 2초마다 알림 생성
      }

      function stopNotifications() {
        // notificationInterval이 존재하면 알림 생성을 중지합니다.
        if (notificationInterval) {
          clearInterval(notificationInterval); // setInterval로 시작된 알림 생성을 중지합니다.
          notificationInterval = null; // ID를 초기화합니다.
        }
      }
    </script>
  </body>
</html>